(()=>{document.querySelector("div.sketch-container");var e=document.querySelector("canvas.sketch"),t=e.getContext("2d");e.width=e.clientWidth,e.height=e.clientHeight;var n=document.querySelector("#colour"),a=document.querySelector("#line-width");t.strokeStyle=n.value,t.lineWidth=a.value,t.lineCap="round";var r,i,l,o,c=!1,u=[],s=[],d=(document.querySelector("div.shapes-container"),document.querySelector("input#height-slider")),h=document.querySelector("input#width-slider"),v=document.querySelector("input#height-value"),f=document.querySelector("input#width-value"),g=document.querySelector("button.fill-shape"),m=document.querySelector("button.undo-shape"),y=document.querySelector("button.create-square"),p=document.querySelector("button.create-triangle"),S=document.querySelector("button.create-circle");h.max=e.clientWidth,d.max=e.clientHeight,f.value=h.value,v.value=d.value,squareCreation=!1,circleCreation=!1,triangleCreation=!1,fillShape="no-fill",shapeArray=[];var C=!1,b=!1,q=!1,L=document.querySelector("#tl-bar-1"),k=document.querySelector("#tl-bar-2"),E=document.querySelector("#sv-btn-toggle"),w=document.querySelector(".toolbar-container-one"),A=document.querySelector(".toolbar-container-two"),W=document.querySelector(".save-btn"),P=function(){document.querySelectorAll(".tool").forEach((function(e){e.disabled=!0}))},T=function(){var e=document.querySelectorAll(".tool");(squareCreation||triangleCreation)&&(document.querySelector("label[for='width-slider']").textContent="Width",e.forEach((function(e){e.disabled=!1})))},x=function(){var e=document.querySelectorAll(".tool");if(circleCreation){document.querySelector("label[for='width-slider']").textContent="Radius";for(var t=0;t<2;t++)e[t].disabled=!1}},M=function(e){for(var t=0;t<e.length;t+=8)"square"===e[t]?H(e[t+1],e[t+2],e[t+3],e[t+4],e[t+5],e[t+6],e[t+7]):"circle"===e[t]?I(e[t+1],e[t+2],e[t+3],e[t+4],e[t+5],e[t+6],e[t+7]):R(e[t+1],e[t+2],e[t+3],e[t+4],e[t+5],e[t+6],e[t+7])},R=function(e,n,a,r,i,l,o){t.lineWidth=n;var c=Math.floor(l/2);"fill"===e?(t.fillStyle=a,t.beginPath(),t.moveTo(r,i),t.lineTo(r-c,i+o),t.lineTo(r+c,i+o),t.fill()):(t.strokeStyle=a,t.beginPath(),t.moveTo(r,i),t.lineTo(r-c,i+o),t.lineTo(r+c,i+o),t.closePath(),t.stroke())},I=function(e,n,a,r,i,l){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;t.lineWidth=n,"fill"===e?(t.fillStyle=a,t.beginPath(),t.arc(r,i,l,o,2*Math.PI),t.fill(),t.stroke()):(t.strokeStyle=a,t.beginPath(),t.arc(r,i,l,o,2*Math.PI),t.stroke())},H=function(e,n,a,r,i,l,o){t.lineWidth=n,"fill"===e?(t.fillStyle=a,t.beginPath(),t.fillRect(r,i,l,o)):(t.strokeStyle=a,t.beginPath(),t.strokeRect(r,i,l,o))},X=function(){squareCreation?y.classList.add("button-toggled"):y.classList.remove("button-toggled"),triangleCreation?p.classList.add("button-toggled"):p.classList.remove("button-toggled"),circleCreation?S.classList.add("button-toggled"):S.classList.remove("button-toggled")},Y=function(){C?w.classList.add("toolbar-el-transition"):w.classList.remove("toolbar-el-transition"),b?A.classList.add("toolbar-el-transition"):A.classList.remove("toolbar-el-transition"),q?W.classList.add("toolbar-el-transition"):W.classList.remove("toolbar-el-transition")};P(),window.addEventListener("resize",(function(r){e.width=e.clientWidth,e.height=e.clientHeight,w.classList.remove("toolbar-el-transition"),A.classList.remove("toolbar-el-transition"),W.classList.remove("toolbar-el-transition"),C=!1,b=!1,q=!1,t.strokeStyle=n.value,t.lineWidth=a.value,t.lineCap="round",z(s),M(shapeArray)}));var z=function(e){if(0!==e.length)for(var n=0;n<e.length;n+=3){t.beginPath(),t.strokeStyle=e[n],t.lineWidth=e[n+1];for(var a=0;a<e[n+2].length;a+=2)t.lineTo(e[n+2][a],e[n+2][a+1]),t.stroke()}},D=function(){s.push(n.value,a.value,u),u=[]};n.addEventListener("change",(function(e){t.strokeStyle=e.target.value,t.fillStyle=e.target.value})),a.addEventListener("change",(function(e){e.target.value>60&&(e.target.value=60),e.target.value<1&&(e.target.value=1),t.lineWidth=e.target.value})),document.querySelector("#clear-canvas").addEventListener("click",(function(n){c=!1,t.clearRect(0,0,e.width,e.height),s=[],shapeArray=[]})),document.querySelector("#undo-change").addEventListener("click",(function(r){!function(n){0!==n.length&&(t.clearRect(0,0,e.width,e.height),n.splice(n.length-3,3))}(s),z(s),M(shapeArray),t.strokeStyle=n.value,t.lineWidth=a.value})),e.addEventListener("mousedown",(function(u){r=u.clientX-e.offsetLeft,i=u.clientY-e.offsetTop,l=parseInt(f.value),o=parseInt(v.value);var s=a.value,d=n.value;squareCreation?(c=!1,r-=Math.floor(l/2),i-=Math.floor(o/2),H(fillShape,s,d,r,i,l,o),function(e,t,n,a,r,i,l){shapeArray.push("square",e,t,n,a,r,i,l)}(fillShape,s,d,r,i,l,o)):circleCreation?(c=!1,I(fillShape,s,d,r,i,l,0),function(e,t,n,a,r,i){shapeArray.push("circle",e,t,n,a,r,i,0)}(fillShape,s,d,r,i,l)):triangleCreation?(c=!1,i-=Math.floor(o/2),R(fillShape,s,d,r,i,l,o),function(e,t,n,a,r,i,l){shapeArray.push("triangle",e,t,n,a,r,i,l)}(fillShape,s,d,r,i,l,o)):(c=!0,t.lineCap="round",t.beginPath())})),e.addEventListener("mouseup",(function(e){squareCreation||triangleCreation||circleCreation||(c=!1,D())})),e.addEventListener("mousemove",(function(n){if(c){if(1!==n.buttons)return c=!1,void D();e.style.cursor="url('images/brush.png'),auto",u.push(n.clientX-e.offsetLeft,n.clientY-e.offsetTop),t.lineTo(n.clientX-e.offsetLeft,n.clientY-e.offsetTop),t.stroke()}else e.style.cursor="default"})),m.addEventListener("click",(function(n){shapeArray,0!==shapeArray.length&&(t.clearRect(0,0,e.width,e.height),shapeArray.splice(shapeArray.length-8,8)),z(s),M(shapeArray)})),g.addEventListener("click",(function(e){"no-fill"===fillShape?(fillShape="fill",e.target.classList.add("button-toggled")):(fillShape="no-fill",e.target.classList.remove("button-toggled"))})),y.addEventListener("click",(function(e){squareCreation?(squareCreation=!1,P(),X()):!squareCreation&&circleCreation||triangleCreation?(P(),circleCreation=!1,triangleCreation=!1,squareCreation=!0,T(),X()):(squareCreation=!0,T(),X())})),S.addEventListener("click",(function(e){circleCreation?(circleCreation=!1,P(),X()):!circleCreation&&squareCreation||triangleCreation?(P(),squareCreation=!1,triangleCreation=!1,circleCreation=!0,x(),X()):(circleCreation=!0,x(),X())})),p.addEventListener("click",(function(e){triangleCreation?(triangleCreation=!1,P(),X()):!triangleCreation&&circleCreation||squareCreation?(P(),circleCreation=!1,squareCreation=!1,triangleCreation=!0,T(),X()):(triangleCreation=!0,T(),X())})),h.addEventListener("change",(function(){f.value=h.value})),d.addEventListener("change",(function(){v.value=d.value})),f.addEventListener("change",(function(){f.value>parseInt(h.max)?f.value=h.max:f.value<0&&(f.value=5),h.value=f.value,takeMeasurements()})),v.addEventListener("change",(function(){v.value>parseInt(d.max)?v.value=d.max:v.value<0&&(v.value=5),d.value=v.value})),document.querySelector("button#save-as").addEventListener("click",(function(t){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"untitled.png",n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click()}(e.toDataURL("image/png",1))})),L.addEventListener("click",(function(e){C?(C=!1,Y()):!C&&b||q?(C=!0,b=!1,q=!1,Y()):(C=!0,Y())})),k.addEventListener("click",(function(e){b?(b=!1,Y()):!b&&C||q?(C=!1,b=!0,q=!1,Y()):(b=!0,Y())})),E.addEventListener("click",(function(e){q?(q=!1,Y()):!q&&C||b?(C=!1,b=!1,q=!0,Y()):(q=!0,Y())}))})();